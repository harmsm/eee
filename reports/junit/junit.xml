<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="146" time="34.379" timestamp="2025-08-28T10:56:08.339776" hostname="banks"><testcase classname="tests._private.check.eee.test_ligand_dict" name="test_check_ligand_dict" time="0.009" /><testcase classname="tests._private.check.eee.test_mut_energy" name="test_check_mut_energy" time="0.006" /><testcase classname="tests._private.check.eee.test_pop_gen" name="test_check_mutation_rate" time="0.004" /><testcase classname="tests._private.check.eee.test_pop_gen" name="test_check_population_size" time="0.004" /><testcase classname="tests._private.check.eee.test_pop_gen" name="test_check_num_generations" time="0.003" /><testcase classname="tests._private.check.eee.test_pop_gen" name="test_check_burn_in_generations" time="0.003" /><testcase classname="tests._private.check.eee.test_pop_gen" name="test_check_num_mutations" time="0.003" /><testcase classname="tests._private.check.eee.test_temperature" name="test_check_temperature" time="0.003" /><testcase classname="tests._private.check.eee.test_wf_population" name="test_check_wf_population" time="0.008" /><testcase classname="tests._private.check.test_check_ensemble" name="test_check_ensemble" time="0.002" /><testcase classname="tests._private.check.test_compare_dict" name="test_compare_dict" time="0.010" /><testcase classname="tests._private.check.test_dataframe" name="test_check_dataframe" time="0.033" /><testcase classname="tests._private.check.test_standard" name="test_check_bool" time="0.001" /><testcase classname="tests._private.check.test_standard" name="test_check_float" time="0.001" /><testcase classname="tests._private.check.test_standard" name="test_check_int" time="0.001" /><testcase classname="tests._private.check.test_standard" name="test_check_iter" time="0.006" /><testcase classname="tests._private.test_interface" name="test_WrappedFunctionException" time="0.000" /><testcase classname="tests._private.test_interface" name="test_run_cleanly" time="0.001" /><testcase classname="tests._private.test_interface" name="test_MockContextManager" time="0.000" /><testcase classname="tests._private.test_interface" name="test_MockContextManager___enter__" time="0.000" /><testcase classname="tests._private.test_interface" name="test_gen_seed" time="0.000" /><testcase classname="tests._private.test_interface" name="test_create_new_dir" time="0.001" /><testcase classname="tests._private.test_interface" name="test_copy_input_file" time="0.002" /><testcase classname="tests._private.test_interface" name="test__follow_log_subproc_wrapper" time="0.000" /><testcase classname="tests._private.test_interface" name="test__follow_log_generator" time="0.000" /><testcase classname="tests._private.test_interface" name="test_launch" time="0.460" /><testcase classname="tests._private.test_interface" name="test_rmtree" time="0.005" /><testcase classname="tests._private.test_logger" name="test_log" time="0.000" /><testcase classname="tests._private.test_utility" name="test_prep_for_json" time="0.011" /><testcase classname="tests._private.test_wrap" name="test_wrap_function" time="0.033" /><testcase classname="tests._private.test_wrap" name="test_IterFromFile" time="0.000" /><testcase classname="tests._private.test_wrap" name="test_IterFromFile___call__" time="0.000" /><testcase classname="tests.analysis.test_cluster_ddg" name="test__clean_up_axes" time="0.001" /><testcase classname="tests.analysis.test_cluster_ddg" name="test_cluster_ddg" time="0.796"><failure message="assert 5 == 4&#10; +  where 5 = len(array([0, 1, 2, 3, 4], dtype=int32))&#10; +    where array([0, 1, 2, 3, 4], dtype=int32) = &lt;function unique at 0x1098c9ff0&gt;(0     4\n1     4\n2     4\n3     4\n4     4\n     ..\n75    2\n76    2\n77    2\n78    1\n79    1\nName: cluster, Length: 76, dtype: int32)&#10; +      where &lt;function unique at 0x1098c9ff0&gt; = np.unique">tmpdir = local('/private/var/folders/p_/hcs03cdj48nbsvw72d92tr040000gn/T/pytest-of-harmsm/pytest-3/test_cluster_ddg0')
test_ddg = {'ddg.csv': '/Users/harmsm/work/programming/git-clones/eee/tests/data_for_tests/test_ddg/ddg.csv', 'lac.csv': '/Users/harmsm/work/programming/git-clones/eee/tests/data_for_tests/test_ddg/lac.csv'}

    def test_cluster_ddg(tmpdir,test_ddg):
    
        current_dir = os.getcwd()
        os.chdir(tmpdir)
    
        should_exist = ["yo_kmeans-elbow-plot.pdf",
                        "yo_clusters.pdf"]
        for e in should_exist:
            assert not os.path.isfile(e)
    
        out = cluster_ddg(test_ddg["ddg.csv"],
                          max_num_clusters=10,
                          elbow_cutoff=0.1,
                          write_prefix="yo",
                          exclude_columns=None)
    
        for e in should_exist:
            assert os.path.isfile(e)
    
&gt;       assert len(np.unique(out["cluster"])) == 4
E       assert 5 == 4
E        +  where 5 = len(array([0, 1, 2, 3, 4], dtype=int32))
E        +    where array([0, 1, 2, 3, 4], dtype=int32) = &lt;function unique at 0x1098c9ff0&gt;(0     4\n1     4\n2     4\n3     4\n4     4\n     ..\n75    2\n76    2\n77    2\n78    1\n79    1\nName: cluster, Length: 76, dtype: int32)
E        +      where &lt;function unique at 0x1098c9ff0&gt; = np.unique

/Users/harmsm/work/programming/git-clones/eee/tests/analysis/test_cluster_ddg.py:97: AssertionError</failure></testcase><testcase classname="tests.analysis.test_dms_epistasis" name="test_dms_epistasis" time="0.000" /><testcase classname="tests.analysis.test_ensemble_fitness" name="test_ensemble_fitness" time="0.029" /><testcase classname="tests.analysis.test_epistasis" name="test_get_epistasis" time="0.001" /><testcase classname="tests.analysis.test_epistasis" name="test_get_ensemble_epistasis" time="0.000" /><testcase classname="tests.analysis.test_epistasis" name="test_get_all_pairs_epistasis" time="0.000" /><testcase classname="tests.analysis.test_epistasis" name="test_summarize_epistasis" time="0.000" /><testcase classname="tests.analysis.test_num_genotypes" name="test_get_num_genotypes" time="0.011" /><testcase classname="tests.analysis.wf.test_analysis" name="test_read_genotypes_file" time="0.000" /><testcase classname="tests.analysis.wf.test_analysis" name="test_get_genotype_frequencies" time="0.000" /><testcase classname="tests.analysis.wf.test_analysis" name="test_get_most_common" time="0.000" /><testcase classname="tests.analysis.wf.test_on_tree" name="test_extract_alignment" time="0.000" /><testcase classname="tests.calcs.test_accessible_paths" name="test_AccessiblePaths" time="0.006" /><testcase classname="tests.calcs.test_accessible_paths" name="test_AccessiblePaths_run" time="0.033" /><testcase classname="tests.calcs.test_dms" name="test_DeepMutationalScan" time="0.006" /><testcase classname="tests.calcs.test_dms" name="test_DeepMutationalScan_run" time="0.016" /><testcase classname="tests.calcs.test_read_json" name="test__validate_calc_kwargs" time="0.001" /><testcase classname="tests.calcs.test_read_json" name="test_read_json" time="6.615" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation" time="0.114" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation__prepare_calc" time="0.006" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation__write_calc_params" time="0.012" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation__complete_calc" time="0.000" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation_system_params" time="0.004" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation_get_calc_description" time="0.020" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation_fitness_from_energy" time="0.004" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation_ens" time="0.004" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation_fc" time="0.004" /><testcase classname="tests.calcs.test_simulation_base" name="test_Simulation_gc" time="0.004" /><testcase classname="tests.calcs.test_simulation_calcs___init__" name="test__get_calc_available" time="0.000" /><testcase classname="tests.calcs.test_wf_sim" name="test_WrightFisherSimulation" time="0.006" /><testcase classname="tests.calcs.test_wf_sim" name="test_WrightFisherSimulation_run" time="0.039" /><testcase classname="tests.calcs.test_wf_tree_sim" name="test_WrightFisherTreeSimulation" time="0.006" /><testcase classname="tests.calcs.test_wf_tree_sim" name="test_WrightFisherTreeSimulation_run" time="0.056" /><testcase classname="tests.core.engine.test_exhaustive" name="test_exhaustive" time="0.079" /><testcase classname="tests.core.engine.test_follow_tree" name="test__simulate_branch" time="0.014" /><testcase classname="tests.core.engine.test_follow_tree" name="test_follow_tree" time="0.848" /><testcase classname="tests.core.engine.test_pathfinder" name="test__traverse" time="0.001" /><testcase classname="tests.core.engine.test_pathfinder" name="test_pathfinder" time="0.044" /><testcase classname="tests.core.engine.test_wright_fisher" name="test_write_wf_outputs" time="3.173" /><testcase classname="tests.core.engine.test_wright_fisher" name="test_wright_fisher" time="4.730" /><testcase classname="tests.core.fitness.test_ff" name="test_ff_on" time="0.000" /><testcase classname="tests.core.fitness.test_ff" name="test_ff_off" time="0.000" /><testcase classname="tests.core.fitness.test_ff" name="test_ff_neutral" time="0.000" /><testcase classname="tests.core.fitness.test_ff" name="test_ff_on_above" time="0.000" /><testcase classname="tests.core.fitness.test_ff" name="test_ff_on_below" time="0.000" /><testcase classname="tests.core.fitness.test_ff" name="test__get_ff_available" time="0.000" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness" time="0.003" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_fitness" time="0.004" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_to_dict" time="0.003" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_ens" time="0.003" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_ligand_dict" time="0.002" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_select_on" time="0.004" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_select_on_folded" time="0.004" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_fitness_kwargs" time="0.004" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_temperature" time="0.005" /><testcase classname="tests.core.fitness.test_fitness" name="test_Fitness_condition_df" time="0.003" /><testcase classname="tests.core.fitness.test_map_fitness_fcn" name="test_map_fitness_fcn" time="0.013" /><testcase classname="tests.core.fitness.test_read_fitness_conditions" name="test_read_fitness_conditions" time="0.065" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype" time="0.006" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype__create_ddg_dict" time="0.002" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype__add_genotype" time="0.001" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_mutate" time="0.009" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_conditional_mutate" time="0.005" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_dump_to_csv" time="0.018" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_to_dict" time="0.002" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_df" time="0.003" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_wt_sequence" time="0.003" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_genotypes" time="0.002" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_trajectories" time="0.001" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_mut_energies" time="0.001" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_fitnesses" time="0.002" /><testcase classname="tests.core.genotype.test_genotype" name="test_Genotype_ddg_dict" time="0.001" /><testcase classname="tests.core.genotype.test_single_genotype" name="test_SingleGenotype" time="0.003" /><testcase classname="tests.core.genotype.test_single_genotype" name="test_SingleGenotype_copy" time="0.000" /><testcase classname="tests.core.genotype.test_single_genotype" name="test_SingleGenotype_mutate" time="0.001" /><testcase classname="tests.core.genotype.test_single_genotype" name="test_SingleGenotype_mut_energy" time="0.000" /><testcase classname="tests.core.genotype.test_single_genotype" name="test_SingleGenotype_mutations" time="0.000" /><testcase classname="tests.core.genotype.test_single_genotype" name="test_SingleGenotype_mutations_accumulated" time="0.000" /><testcase classname="tests.core.genotype.test_single_genotype" name="test_SingleGenotype_sites" time="0.000" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble" time="0.004" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_add_species" time="0.014" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble__build_z_matrix" time="0.003" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble__get_weights" time="0.002" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_get_species_dG" time="0.020" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_get_obs" time="0.063" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_read_ligand_dict" time="0.002" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_mut_dict_to_array" time="0.000" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_get_fx_obs_fast" time="0.000" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_get_dG_obs_fast" time="0.000" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_to_dict" time="0.000" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_get_observable_function" time="0.003" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_species" time="0.000" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_ligands" time="0.000" /><testcase classname="tests.core.test_ensemble" name="test_Ensemble_species_df" time="0.002" /><testcase classname="tests.io.test_read_dataframe" name="test_read_dataframe" time="0.177" /><testcase classname="tests.io.test_read_ddg" name="test_read_ddg" time="0.003" /><testcase classname="tests.io.test_read_ensemble" name="test__search_for_key" time="0.000" /><testcase classname="tests.io.test_read_ensemble" name="test__spreadsheet_to_ensemble" time="0.016" /><testcase classname="tests.io.test_read_ensemble" name="test__json_to_ensemble" time="0.010" /><testcase classname="tests.io.test_read_ensemble" name="test__file_to_ensemble" time="0.005" /><testcase classname="tests.io.test_read_ensemble" name="test_read_ensemble" time="0.012" /><testcase classname="tests.io.test_read_structure" name="test__read_structure_cif" time="0.204" /><testcase classname="tests.io.test_read_structure" name="test__read_structure_pdb" time="0.220" /><testcase classname="tests.io.test_read_structure" name="test_read_structure" time="1.162" /><testcase classname="tests.io.test_read_tree" name="test_read_tree" time="0.009" /><testcase classname="tests.io.test_write_pdb" name="test_write_pdb" time="0.338" /><testcase classname="tests.io.test_write_tree" name="test_write_tree" time="0.012" /><testcase classname="tests.structure.test_align_structure_seqs" name="test__run_muscle" time="0.000" /><testcase classname="tests.structure.test_align_structure_seqs" name="test_align_structure_seqs" time="10.089" /><testcase classname="tests.structure.test_align_structures" name="test_align_structures" time="0.000" /><testcase classname="tests.structure.test_clean_structure" name="test_clean_structure" time="0.000" /><testcase classname="tests.structure.test_sync_structures" name="test__create_unique_filenames" time="0.000" /><testcase classname="tests.structure.test_sync_structures" name="test_sync_structures" time="3.287" /></testsuite></testsuites>